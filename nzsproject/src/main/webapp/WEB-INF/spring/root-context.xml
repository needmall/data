<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<!-- Root Context: defines shared resources visible to all other web components -->

	<!--  DataSource  -->
	<bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
      <property name="jndiName" value="java:comp/env/jdbc/nzs" />
	</bean>
	
	<!-- Mybatis Setting -->
	<!-- -SqlSessionFactory는 데이터베이스와의 연결과 SQL의 실행에 대한 모든 것읅 가진 가장 중요한 객체이다.-->
	<!-- -SqlSessionFactory를 생성해 주는 객체를 설정해 주어야 하는데 SqlSessionFactoryBean이라는 클래스이다. -->
	<bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
      <property name="dataSource" ref="dataSource" />
      <property name="configLocation" value="classpath:config/mybatis-config.xml" />
      <property name="mapperLocations" value="classpath:query/*.xml" />
   </bean>
	
	<!-- 스프링과 Mybatis 를 연동하는데 필요한 클래스 두개중 하나. (하나는 위의 SqlSessionFactoryBean) -->
	<bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate" destroy-method="clearCache">
      <constructor-arg name="sqlSessionFactory" ref="sqlSessionFactory" /><!-- 생성자 주입만 가능 -->
   </bean>

	
	<!-- a PlatformTransactionManager is still required -->
	<bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
      <property name="dataSource" ref="dataSource" />
   </bean>
	
	<!-- 현재 mapper 어디에서 쓰여질지 알려줌 -->
	 <bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">
      <property name="basePackage">
         <value>com.needmall.**.**.dao</value><!-- 공통환경설정 -->
      </property>
   </bean>
</beans>
